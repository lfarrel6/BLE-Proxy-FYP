<!DOCTYPE html>
<html>
<head>
	<title>Homepage</title>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans|Raleway|Roboto+Slab" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/scripts/style.css">
	<link type="text/javascript" href="/scripts/index.js">
	<link rel="icon" href="/assets/favicon.png">
</head>
<body>

<a class="floating-btn" id="github-btn" href="https://github.com/lfarrel6/BLE-Proxy-FYP"><img src="/assets/GitHub-Mark-64px.png" alt="View on GitHub!"></a>

<div class="skewed">
	<div class="container deskew">
		<input type="text" id="ip-entry" name="ip-address"  placeholder="Enter the CoAP Server IP...">
		<p id='ip-err-msg'><span class="warning">⚠️</span>Enter a valid <a href="http://bit.ly/1ReCgWo">IPv4</a> or <a href="http://bit.ly/1Qkr8FK">IPv6</a> address.<span class="warning">⚠️</span></p>
		<button type="submit" id="ip-submit" onclick="ipSubmit()">Enter</button>
	</div>
</div>
<div class="info-box blue-bg">
	<h1>About this service</h1>
	<p class="info-block">This service proxies data from BLE sensors using a CoAP server. This webpage acts as a client to the CoAP server!<br>All you need to know is the IP address of the CoAP server. Entering it into the text field above will check if the server is <b>out there</b>.<br>If the server exists, you will be brought to the dashboard, which displays all of the BLE devices discovered by the CoAP server.</p>
</div>

</body>
<script type="text/javascript">
	
function ipSubmit(){
	var enteredIp = document.getElementById('ip-entry').value;

	var ipv4 = new RegExp("^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$");
	var ipv6 = new RegExp("^[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}:[\da-fA-F]{0,4}$")

	console.log(enteredIp + ' submitted');

	if(ipv4.test(enteredIp) || ipv6.test(enteredIp) || enteredIp === 'localhost'){
		document.getElementById('ip-err-msg').style.visibility = 'visible';
		location.href = location.href + 'dashboard/' + enteredIp;
	}else{
		console.log('Invalid Entry. IPv4 or IPv6 expected.');
		document.getElementById('ip-err-msg').style.visibility = 'visible';
	}
}

</script>
</html>